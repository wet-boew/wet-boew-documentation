---
published: true
layout: default-theme-wet-boew-en
title: 2019-15 - Chat Wizard
description: Exploration of a chat like design pattern
modified: 2019-02-06
---

{::nomarkdown}

{% raw %}

<div class="row">
	<div class="col-md-4 col-xs-12 pull-right">
		<section class="lnkbx">
			<h2>
			Most requested
			</h2>
			<ul>
				<li><a href="#">		[Top task hyperlink text]
				</a></li>
				<li><a href="#">		[Top task hyperlink text]
				</a></li>
				<li><a href="#">		[Top task hyperlink text]
				</a></li>
				<li><a href="#">		[Top task hyperlink text]
				</a></li>
				<li><a href="#">		[Top task hyperlink text]
				</a></li>
				<li><a href="#">		[Top task hyperlink text]
				</a></li>
				<li><a href="#">		[Top task hyperlink text]
				</a></li>
			</ul>
		</section>	</div>
		<div class="container wb-chtbt chtbt-basic">
			<div class="row">
				<section class="col-md-12">
					<h2>Help us help you</h2>
					<form class="mrgn-bttm-xl" data-wb-chtbt='{"action":"search", "send":"Show results"}'>
						<fieldset>
							<legend id="q1" data-wb-chtbt-q="Are you:">What would you describe yourself as?</legend>
							<ul class="list-unstyled mrgn-tp-md">
								<li>
									<label data-wb-chtbt-a='{"next":"#q2","url":"page1.html"}'>
										<input type="radio" value="young-canadian" name="q1" />
										a young Canadian
									</label>
								</li>
								<li>
									<label data-wb-chtbt-a='{"url":"page2.html"}'>
										<input type="radio" value="employer-organization-funding-support-youth" name="q1" />
										an employer or organization looking for funding to support youth
									</label>
								</li>
							</ul>
						</fieldset>
						<fieldset>
							<legend id="q2" data-wb-chtbt-q="Great! And are you:">In what situation are you?</legend>
							<ul class="list-unstyled mrgn-tp-md">
								<li>
									<label data-wb-chtbt-a='{"next":"#q3","url":"page1.html"}'>
										<input type="radio" value="high-school" name="q2" />
										a high school student
									</label>
								</li>
								<li>
									<label data-wb-chtbt-a='{"next":"#q3","url":"page1.html"}'>
										<input type="radio" value="cegep-student" name="q2" />
										a CÉGEP student
									</label>
								</li>
								<li>
									<label data-wb-chtbt-a='{"next":"#q3","url":"page1.html"}'>
										<input type="radio" value="post-secondary" name="q2" />
										a post-secondary school student
									</label>
								</li>
								<li>
									<label data-wb-chtbt-a='{"next":"#q3","url":"page1.html"}'>
										<input type="radio" value="ready-start-career" name="q2" />
										ready to start a career
									</label>
								</li>
								<li>
									<label data-wb-chtbt-a='{"next":"#q3","url":"page1.html"}'>
										<input type="radio" value="not-school-not-working" name="q2" />
										not in school and not working
									</label>
								</li>
								<li>
									<label data-wb-chtbt-a='{"next":"#q3","url":"page1.html"}'>
										<input type="radio" value="none" name="q2" />
										none of these
									</label>
								</li>
							</ul>
						</fieldset>
						<fieldset>
							<legend data-wb-chtbt-q="Awesome! And would you like to:">What is your goal?</legend>
							<ul class="list-unstyled mrgn-tp-md">
								<li>
									<label data-wb-chtbt-a='{"url":"page3.html"}'>
										<input type="radio" value="get-job" name="q3" />
										get a job
									</label>
								</li>
								<li>
									<label data-wb-chtbt-a='{"url":"page4.html"}'>
										<input type="radio" value="develop-skills" name="q3" />
										develop skills
									</label>
								</li>
								<li>
									<label data-wb-chtbt-a='{"url":"page5.html"}'>
										<input type="radio" value="explore-careers" name="q3" />
										explore careers
									</label>
								</li>
								<li>
									<label data-wb-chtbt-a='{"url":"page6.html"}'>
										<input type="radio" value="post-secondary-education" name="q3" />
										attend post-secondary education
									</label>
								</li>
								<li>
									<label data-wb-chtbt-a='{"url":"page7.html"}'>
										<input type="radio" value="serve-community" name="q3" />
										serve your community
									</label>
								</li>
								<li>
									<label data-wb-chtbt-a='{"url":"page8.html"}'>
										<input type="radio" value="get-experience" name="q3" />
										get an experience
									</label>
								</li>
								<li>
									<label data-wb-chtbt-a='{"url":"page1.html"}'>
										<input type="radio" value="everything" name="q3" />
										see everything
									</label>
								</li>
							</ul>
						</fieldset>
						<button type="submit" class="btn btn-sm btn-default chtbt-link">Switch to help wizard</button>
						<button type="submit" class="btn btn-sm btn-primary" data-chtbt-end="Thank you. I have built a page with results you may find resourceful.">Search</button>
					</form>
				</section>
			</div>
		</div>
	<section class="col-md-8 pull-left">
		<h2>Services and information</h2>
		<div class="wb-eqht row">
			<div class="col-md-6">
				<section>
					<h3 class="h5"><a href="#">
					[Subtopic hyperlink text]
					</a></h3>
					<p>
					Summary of the information or tasks that can be accomplished on the sub-topic page. Remove prose or promotional messaging. Use action verbs.
					</p>
				</section>
			</div>			<div class="col-md-6">
				<section>
					<h3 class="h5"><a href="#">
					[Subtopic hyperlink text]
					</a></h3>
					<p>
					Summary of the information or tasks that can be accomplished on the sub-topic page. Remove prose or promotional messaging. Use action verbs.
					</p>
				</section>
			</div>			<div class="col-md-6">
				<section>
					<h3 class="h5"><a href="#">
					[Subtopic hyperlink text]
					</a></h3>
					<p>
					Summary of the information or tasks that can be accomplished on the sub-topic page. Remove prose or promotional messaging. Use action verbs.
					</p>
				</section>
			</div>			<div class="col-md-6">
				<section>
					<h3 class="h5"><a href="#">
					[Subtopic hyperlink text]
					</a></h3>
					<p>
					Summary of the information or tasks that can be accomplished on the sub-topic page. Remove prose or promotional messaging. Use action verbs.
					</p>
				</section>
			</div>			<div class="col-md-6">
				<section>
					<h3 class="h5"><a href="#">
					[Subtopic hyperlink text]
					</a></h3>
					<p>
					Summary of the information or tasks that can be accomplished on the sub-topic page. Remove prose or promotional messaging. Use action verbs.
					</p>
				</section>
			</div>			<div class="col-md-6">
				<section>
					<h3 class="h5"><a href="#">
					[Subtopic hyperlink text]
					</a></h3>
					<p>
					Summary of the information or tasks that can be accomplished on the sub-topic page. Remove prose or promotional messaging. Use action verbs.
					</p>
				</section>
			</div>			<div class="col-md-6">
				<section>
					<h3 class="h5"><a href="#">
					[Subtopic hyperlink text]
					</a></h3>
					<p>
					Summary of the information or tasks that can be accomplished on the sub-topic page. Remove prose or promotional messaging. Use action verbs.
					</p>
				</section>
			</div>			<div class="col-md-6">
				<section>
					<h3 class="h5"><a href="#">
					[Subtopic hyperlink text]
					</a></h3>
					<p>
					Summary of the information or tasks that can be accomplished on the sub-topic page. Remove prose or promotional messaging. Use action verbs.
					</p>
				</section>
			</div>			<div class="col-md-6">
				<section>
					<h3 class="h5"><a href="#">
					[Subtopic hyperlink text]
					</a></h3>
					<p>
					Summary of the information or tasks that can be accomplished on the sub-topic page. Remove prose or promotional messaging. Use action verbs.
					</p>
				</section>
			</div>			<div class="col-md-6">
				<section>
					<h3 class="h5"><a href="#">
					[Subtopic hyperlink text]
					</a></h3>
					<p>
					Summary of the information or tasks that can be accomplished on the sub-topic page. Remove prose or promotional messaging. Use action verbs.
					</p>
				</section>
			</div>			<div class="col-md-6">
				<section>
					<h3 class="h5"><a href="#">
					[Subtopic hyperlink text]
					</a></h3>
					<p>
					Summary of the information or tasks that can be accomplished on the sub-topic page. Remove prose or promotional messaging. Use action verbs.
					</p>
				</section>
			</div>			<div class="col-md-6">
				<section>
					<h3 class="h5"><a href="#">
					[Subtopic hyperlink text]
					</a></h3>
					<p>
					Summary of the information or tasks that can be accomplished on the sub-topic page. Remove prose or promotional messaging. Use action verbs.
					</p>
				</section>
			</div>		</div>
	</section>
	<div class="pull-right col-xs-12 col-md-4">
		<section class="lnkbx">
			<h2>
			Contributors
			</h2>
			<ul>
				<li><a href="#">[Institution name]</a></li>
				<li><a href="#">[Institution name]</a></li>
				<li><a href="#">[Institution name]</a></li>
			</ul>
		</section>
		<section class="lnkbx">
			<h2>More information for</h2>
			<ul>
				<li><a href="#">[Audience hyperlink text]</a></li>
				<li><a href="#">[Audience hyperlink text]</a></li>
				<li><a href="#">[Audience hyperlink text]</a></li>
			</ul>
		</section>
	</div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.js"></script>
<!-- Chat bot -->
<script>
// Data structure example for a working chatbot
var datainput = {
	header: {
		action: "search", 
		send: "Show results",
		endtext: "Thank you. I have built a page with results you may find resourceful.",
		starttext: "Hi! I can help direct you to programs and services you might be interested in. Let's begin...",
		first: "q1"
	}, 
	questions: {
		q1: 
		{
			queryName: "describe",
			labelform: "What would you describe yourself as?",
			labelwizard: "Are you:",
			input: "radio",
			choices: [
				{ 
					content: "a young Canadian",
					queryParam: "young-canadian",
					next: "q2"
				},
				{ 
					content: "an employer or organization looking for funding to support youth",
					queryParam: "employer-organization-funding-support-youth",
					next: "none",
					url: "2019-15-exploration-chat-pattern-prototype-results.html"
				}
			]
		}, 
		q2:
		{
			queryName: "situation",
			labelform: "In what situation are you?",
			labelwizard: "Great! And are you:",
			input: "radio",
			choices: [
				{ 
					content: "a high school student",
					queryParam: "high-school",
					next: "q3"
				},
				{ 
					content: "a CÉGEP student",
					queryParam: "cegep-student",
					next: "q3"
				},
				{ 
					content: "a post-secondary school student",
					queryParam: "post-secondary",
					next: "q3"
				},
				{ 
					content: "ready to start a career",
					queryParam: "ready-start-career",
					next: "q3"
				},
				{ 
					content: "not in school and not working",
					queryParam: "not-school-not-working",
					next: "q3"
				},
				{ 
					content: "none of these",
					queryParam: "none",
					next: "q3"
				}
			]
		},
		q3:
		{
			queryName: "goal",
			labelform: "What is your goal?",
			labelwizard: "Awesome! And would you like to:",
			input: "radio",
			choices: [
				{ 
					content: "get a job",
					queryParam: "get-job",
					next: "none",
					url: "2019-15-exploration-chat-pattern-prototype-results.html"
				},
				{ 
					content: "develop skills",
					queryParam: "develop-skills",
					next: "none",
					url: "2019-15-exploration-chat-pattern-prototype-results.html"
				},
				{ 
					content: "explore careers",
					queryParam: "explore-careers",
					next: "none",
					url: "2019-15-exploration-chat-pattern-prototype-results.html"
				},
				{ 
					content: "attend post-secondary education",
					queryParam: "post-secondary-education",
					next: "none",
					url: "2019-15-exploration-chat-pattern-prototype-results.html"
				},
				{ 
					content: "serve your community",
					queryParam: "serve-community",
					next: "none",
					url: "2019-15-exploration-chat-pattern-prototype-results.html"
				},
				{ 
					content: "get an experience",
					queryParam: "get-experience",
					next: "none",
					url: "2019-15-exploration-chat-pattern-prototype-results.html"
				},
				{ 
					content: "see everything",
					queryParam: "everything",
					next: "none",
					url: "2019-15-exploration-chat-pattern-prototype-results.html"
				}
			]
		}
	}
};
			
// For testing purposes, stringify the JavaScipt Object Array
var datajson = JSON.stringify(datainput);

// Parsing JSON Data Source
datainput = JSON.parse(datajson);

// Create the data that is sent as an output, if needed + check if user has answered + determine index of question
var dataoutput = [],
	hasAnswered = true, 
	first = datainput.header.first,
	redirurl = "",
	current = datainput.questions[datainput.header.first];

// If chatbot is found, initiate
function initiateChtbt($selector, $input="JSON") {
	buildChtbt($selector);

	var $basic = $(".chtbt-basic"), 
		$bubble = $(".chtbt-bubble-wrap"), 
		$container = $(".chtbt-container"), 
		$form = $(".chtbt-body");

	$basic.hide();
	$bubble.fadeIn('slow');

	setTimeout(function () {
		$bubble.find('p').hide();
	}, 14850);

	// Show basic form and hide chatbot
	$(".chtbt-basic-link").on("click", function(event) {
		event.preventDefault();
		$container.stop().hide();

		$basic.stop().show();
		$basic.find("input:first").focus();
		$("body").removeClass("chtbt-noscroll");
	});

	// Show chatbot and hide basic form
	$(".chtbt-link").on("click", function(event) {
		event.preventDefault();
		$basic.stop().hide();

		$bubble.find(".chtbt-bubble").removeClass("chtbt-trans-pulse");
		$bubble.find("p").hide().removeClass("chtbt-trans-left");

		$container.stop().show();
		$bubble.stop().hide();
		$(".chtbt-conversation").scrollTop($('.chtbt-history')[0].scrollHeight);
		$("body").addClass("chtbt-noscroll");

		if(hasAnswered) {
			appendInteraction($form);
		}
	});

	// On Submit answer
	$form.on("submit", function(event) {
		event.preventDefault();
		appendReply($form, $("input:checked"));
	})

	// Minimize chatbot
	$(".chtbt-min").on("click", function(event) {
		event.preventDefault();
		$container.stop().hide();
		$bubble.stop().show();
		$("body").removeClass("chtbt-noscroll");
	});
}

// Builds the chatbot skeleton
function buildChtbt($selector) {
	$selector.after('<div class="chtbt-bubble-wrap"><p class="chtbt-trans-left">I can help you find the information you need</p><a href="#chtbt-container" aria-controls="chtbt-container" class="chtbt-link chtbt-bubble chtbt-trans-pulse" role="button">Toggle help wizard</a></div>');
	$selector.next('.chtbt-bubble-wrap').after('<aside class="modal-content overlay-def chtbt-container"></a>');

	$container = $(".chtbt-container");
	$container.append('<header class="modal-header chtbt-header"><h2 class="modal-title chtbt-title">I can help you find the information you need</h2><button type="button" class="chtbt-min" title="Minimize help wizard"><span class="glyphicon glyphicon-chevron-down"></span></button></header>');
	$container.append('<form class="modal-body chtbt-body"></form>');

	$form = $(".chtbt-body");
	$form.append('<div class="chtbt-conversation mrgn-bttm-md"><section class="chtbt-history"><h3 class="wb-inv">Conversation history</h3></section><section class="chtbt-reply"><h3 class="wb-inv">Reply</h3><div class="chtbt-inputs"></div></section></div>');
	$form.append('<section class="chtbt-controls"><h3 class="wb-inv">Controls</h3><div class="row"><div class="col-xs-12"><button type="submit" class="btn btn-primary btn-block" type="button">Send</button></div></div><div class="row"><div class="col-xs-12 text-center mrgn-tp-sm"><a href="#chtbt-basic" class="btn btn-sm btn-link chtbt-basic-link" role="button">Switch to basic form</a></div></div></section>');

	$(".chtbt-conversation").scrollTop($('.chtbt-history')[0].scrollHeight);
}

// Adds new question from bot and inputs
function appendInteraction($selector, last) {
	hasAnswered = false;
	$selector.find(":input[type=submit]").prop('disabled', true);
	var $dropspot = $selector.find(".chtbt-history");
	$dropspot.append('<div class="row mrgn-bttm-sm"><div class="col-xs-9"><h4 class="mrgn-tp-0 mrgn-bttm-sm"><span class="chtbt-avatar"></span><span class="chtbt-question"><span class="chtbt-loader"><span class="chtbt-loader-dot dot1"></span><span class="chtbt-loader-dot dot2"></span><span class="chtbt-loader-dot dot3"></span></span></span></h4></div></div>');

	var $inputsSpot = $selector.find(".chtbt-inputs");
	$inputsSpot.html('');
	var questionnaire = datainput.header;

	setTimeout(function () {
		if(first != "") {
			$dropspot.find(".chtbt-question").last().html(questionnaire.starttext);
			first = "";
			appendInteraction($selector, false);
		} else if(current == "last") {
			var paramStr = "",
				btnclasses = $selector.find(":input[type=submit]").attr('class'); // For demo purposes

			for(var i=0; i<dataoutput.length; i++) {
				paramStr += dataoutput[i].qId + "=" + dataoutput[i].answer + '&';
			}
			paramStr = paramStr.slice(0, -1);
			$dropspot.find(".chtbt-question").last().html(questionnaire.endtext);
			$selector.find(":input[type=submit]").replaceWith('<a class="' + btnclasses + '" href="' + redirurl + '?' + paramStr + '">' + questionnaire.send + ' <span class="glyphicon glyphicon-chevron-right small"></span></a>');
		} else {
			$dropspot.find(".chtbt-question").last().html(current.labelwizard);
			setTimeout(function () {
				$inputsSpot.append('<fieldset><legend class="wb-inv">' + current.labelwizard + '</legend><div class="row"><div class="col-xs-12"><ul class="list-inline mrgn-tp-sm chtbt-choices"></ul></div></div></fieldset>');
				for(var i=0; i<current.choices.length; i++) {
					iQuestion = current.choices[i];	
					$inputsSpot.find(".chtbt-choices").append('<li><label><input type="' + current.input + '" value="' + iQuestion.queryParam + '" name="' + current.queryName + '" data-chtbt-next="' + iQuestion.next + '"' + (typeof iQuestion.url === "undefined" ? '' : 'data-chtbt-url="' + iQuestion.url + '"') + ' /> <span>' + iQuestion.content + '</span></label></li>');
				}
				if($(".chtbt-reply").outerHeight() > ($(".chtbt-conversation").innerHeight() - $(".chtbt-question:last")[0].scrollHeight)) {
					$(".chtbt-conversation").stop().animate({scrollTop:$(".chtbt-history").outerHeight() - $(".chtbt-question:last")[0].scrollHeight - 30}, 500, 'swing');
				} else {
					$(".chtbt-conversation").scrollTop($(".chtbt-history")[0].scrollHeight);
				}
				$selector.find(":input[type=submit]").prop('disabled', false);
			}, 750);
		}
		$(".chtbt-conversation").scrollTop($(".chtbt-history")[0].scrollHeight);
	}, 1750);
}

// Adds reply from human and calls next question
function appendReply($selector, $answer) {
	$selector.find(":input[type=submit]").prop('disabled', true);
	dataoutput.push({qId: current.queryName, answer: $answer.next().html()});	// Should be $answer.val()
	console.log(dataoutput);	// For testing purposes
	$dropspot = $selector.find(".chtbt-history");
	$dropspot.append('<div class="row mrgn-bttm-md"><div class="col-xs-9 col-xs-offset-3"><div class="chtbt-message text-right pull-right"><p class="mrgn-bttm-0">' + $answer.next("span").html() + '</p></div></div></div>');
	hasAnswered = true;
	setTimeout(function () {
		$selector.find(".chtbt-inputs").remove("fieldset");
		var next = $answer.data('chtbt-next');
		if(next == "none") {
			current = "last";
			redirurl = $answer.data('chtbt-url');
		} else {
			current = datainput.questions[next];
		}
		appendInteraction($selector);
	}, 500);
}

if($(".wb-chtbt").length) {
	$chtbt = $(".wb-chtbt");
	initiateChtbt($chtbt);
}
</script>

{% endraw %}

{:/}